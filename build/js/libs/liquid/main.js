'use strict';(function(){window.CanvasSlideshow=function(a){function b(){h.rotation+=1e-3,s=requestAnimationFrame(b)}var d=this;a=a||{},a.pixiSprites=a.hasOwnProperty('sprites')?a.sprites:[],a.centerSprites=!!a.hasOwnProperty('centerSprites')&&a.centerSprites,a.texts=a.hasOwnProperty('texts')?a.texts:[],a.autoPlay=!a.hasOwnProperty('autoPlay')||a.autoPlay,a.autoPlaySpeed=a.hasOwnProperty('autoPlaySpeed')?a.autoPlaySpeed:[10,3],a.fullScreen=!a.hasOwnProperty('fullScreen')||a.fullScreen,a.displaceScale=a.hasOwnProperty('displaceScale')?a.displaceScale:[200,70],a.displacementImage=a.hasOwnProperty('displacementImage')?a.displacementImage:'',a.navElement=a.hasOwnProperty('navElement')?a.navElement:document.querySelectorAll('.scene-nav'),a.displaceAutoFit=!!a.hasOwnProperty('displaceAutoFit')&&a.displaceAutoFit,a.wacky=!!a.hasOwnProperty('wacky')&&a.wacky,a.interactive=!!a.hasOwnProperty('interactive')&&a.interactive,a.interactionEvent=a.hasOwnProperty('interactionEvent')?a.interactionEvent:'',a.displaceScaleTo=!1===a.autoPlay?[0,0]:[20,20],a.textColor=a.hasOwnProperty('textColor')?a.textColor:'#fff',a.displacementCenter=!!a.hasOwnProperty('displacementCenter')&&a.displacementCenter,a.dispatchPointerOver=!!a.hasOwnProperty('dispatchPointerOver')&&a.dispatchPointerOver;var e=new PIXI.autoDetectRenderer(a.stageWidth,a.stageHeight,{transparent:!0}),f=new PIXI.Container,g=new PIXI.Container,h=new PIXI.Sprite.fromImage(a.displacementImage),j=new PIXI.filters.DisplacementFilter(h),k=new PIXI.TextStyle({fill:a.textColor,wordWrap:!0,wordWrapWidth:400,letterSpacing:20,fontSize:14});if(this.currentIndex=0,this.initPixi=function(){document.getElementById('liquid_effect').appendChild(e.view),f.addChild(g),f.interactive=!0,!0===a.fullScreen?(e.view.style.width='100%',e.view.style.height='100%',e.view.style.webkitTransform='scale(1.2)',e.view.style.transform=' scale(1.2)'):(e.view.style.maxWidth='100%',e.view.style.top='50%',e.view.style.left='50%',e.view.style.webkitTransform='translate( -50%, -50% )',e.view.style.transform='translate( -50%, -50% )'),h.texture.baseTexture.wrapMode=PIXI.WRAP_MODES.REPEAT,f.filters=[j],!1===a.autoPlay&&(j.scale.x=0,j.scale.y=0),!0===a.wacky&&(h.anchor.set(0.5),h.x=e.width/2,h.y=e.height/2),h.scale.x=2,h.scale.y=2,j.autoFit=a.displaceAutoFit,f.addChild(h)},this.loadPixiSprites=function(v){for(var w=a.sprites,x=a.texts,y=0;y<w.length;y++){var z=new PIXI.Texture.fromImage(v[y]),A=new PIXI.Sprite(z);if(x){var B=new PIXI.Text(x[y],k);A.addChild(B),B.anchor.set(0.5),B.x=A.width/2,B.y=A.height/2}!0===a.centerSprites&&(A.anchor.set(0.5),A.x=e.width/2,A.y=e.height/2),0!==y&&TweenMax.set(A,{alpha:0}),g.addChild(A)}},!0===a.autoPlay){var l=new PIXI.ticker.Ticker;l.autoStart=a.autoPlay,l.add(function(v){h.x+=a.autoPlaySpeed[0]*v,h.y+=a.autoPlaySpeed[1],e.render(f)})}else{var m=new PIXI.ticker.Ticker;m.autoStart=!0,m.add(function(){e.render(f)})}var n=!1,o=g.children;this.moveSlider=function(v){n=!0;var w=new TimelineMax({onComplete:function onComplete(){d.currentIndex=v,n=!1,!0===a.wacky&&h.scale.set(1)},onUpdate:function onUpdate(){!0===a.wacky&&(h.rotation+=0.02*w.progress(),h.scale.set(3*w.progress()))}});w.clear(),w.isActive()||w.to(j.scale,1,{x:a.displaceScale[0],y:a.displaceScale[1]}).to(o[d.currentIndex],0.5,{alpha:0}).to(o[v],0.5,{alpha:1}).to(j.scale,1,{x:a.displaceScaleTo[0],y:a.displaceScaleTo[1]})};for(var r,p=a.navElement,q=0;q<p.length;q++)r=p[q],r.onclick=function(){return!n&&('next'===this.getAttribute('data-nav')?0<=d.currentIndex&&d.currentIndex<o.length-1?d.moveSlider(d.currentIndex+1):d.moveSlider(0):0<d.currentIndex&&d.currentIndex<o.length?d.moveSlider(d.currentIndex-1):d.moveSlider(spriteImages.length-1),!1)};if(this.init=function(){d.initPixi(),d.loadPixiSprites(a.pixiSprites)},!0===a.interactive){var s,t,u;g.interactive=!0,g.buttonMode=!0,('hover'===a.interactionEvent||'both'===a.interactionEvent)&&(g.pointerover=function(v){t=v.data.global.x,u=v.data.global.y,TweenMax.to(j.scale,1,{x:'+='+100*Math.sin(t)+'',y:'+='+100*Math.cos(u)+''}),b()},g.pointerout=function(){TweenMax.to(j.scale,1,{x:0,y:0}),cancelAnimationFrame(s)}),('click'===a.interactionEvent||'both'===a.interactionEvent)&&(g.pointerup=function(){!0===a.dispatchPointerOver?TweenMax.to(j.scale,1,{x:0,y:0,onComplete:function onComplete(){TweenMax.to(j.scale,1,{x:20,y:20})}}):(TweenMax.to(j.scale,1,{x:0,y:0}),cancelAnimationFrame(s))},g.pointerdown=function(v){t=v.data.global.x,u=v.data.global.y,TweenMax.to(j.scale,1,{x:'+='+1200*Math.sin(t)+'',y:'+='+200*Math.cos(u)+''})},g.pointerout=function(){!0===a.dispatchPointerOver?TweenMax.to(j.scale,1,{x:0,y:0,onComplete:function onComplete(){TweenMax.to(j.scale,1,{x:20,y:20})}}):(TweenMax.to(j.scale,1,{x:0,y:0}),cancelAnimationFrame(s))})}!0===a.displacementCenter&&(h.anchor.set(0.5),h.x=e.view.width/2,h.y=e.view.height/2),this.init()}})();
